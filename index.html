
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"/>
<title>m².js - modular micro framework</title>
<meta http-equiv="x-ua-compatible" content="ie=edge"/>
<meta viewport="width=device-width"/>
<style>
html, body, * { font: 13px sans-serif; }
h1 { font-size: 250%; font-weight: 400; }
h2 { font-size: 125%; font-weight: 700; }
h3 { font-size: 120%; }
h4 { font-size: 110%; }
h5 { font-size: 100%; }
pre { padding: 20px; }
pre, pre * { font: 12px monospace; white-space: pre-wrap; tab-size: 4; }
/* syntax highlighting */
/* regexp */
.f-1, .f-1 * {color:#092;}
/* string */
.f1,.f1 * {color:#d14;}
/* comment */
.f2,.f2 * {color:#999;font-style:italic;}
/* keyword */
.f3,.f3 * {color:#000;font-weight: 700;}
/* predefined object */
.f4,.f4 * {color:#08B;}
/* number */
.f5,.f5 * {color:#099;}
/* bracket, operator */
.f6 {color:#000;}
</style>
<script type="text/javascript">
// m² 0.0.1 - modular JS micro framework (c) 2013 by Alex Kloss
!function (d, p/**query-full**/, g/**jsonp**/, j/**/, l, a/**cookie**/, c, e/**query-full**/, r/**/, u) {
/*
	Initialisation:
	- instantiation with "new" if necessary
	- DOM queries vs. other functions (handled via "i"nit method)
	m([DOM query, Array, DOM node, onready callback function], [opt: DOM query base])
*/
m = function (q, b) { return this instanceof m ? '' + q === q ? /**query-performance**/(!b && (b = /^#(\S+)$|^\[name=([^\]]+)\]$|^([a-zA-Z]+)$/.exec(q))) ? this.i(d['getElement' + (b[1] ? 'ById' : b[2] ? 'sByName' : 'sByTagName')](b[1] || b[2] || b[3])) :/**/m(b || d).find(q) : /^f/.test(typeof q) ? m().ready(q/**elementready**/, b/**/) : this.i(q) : new m(q, b) }
m[p] = {
	// basic length
	length: 0,
	// initialisation for everything but functions or DOM queries
	i: function (q, x) {
		x = (q || 0).nodeName ? [q] : [], (q && 1 + q[l]) && m.each(q, function(n){ x.push(n) });
		a.push.apply(this, x)
	},
	// DOMready
	ready: function (f/**elementready**/, b/**/) { (function t(){ /**elementready**/(b ? m(b)[l] : /**//c/.test(d.readyState)/**elementready**/)/**/ ? f() : setTimeout(t, 99) })() },
	// Iterator
	each: function (a) { return m.each(this, a) },
	// Filtering m(...).filter([function returning either true to keep the node or something like an Array to replace it]), otherwise works as unique()
	filter: function (f, r) {
		r = []
		this.each(function (n, i, c, o) {
			c = !f || f.call(n, n, i)
			c = c === !0 ? [n] : c && c[0] ? c : []
			for (o = 0; n = c[o++]; ~i || r.push(n))
				for (i = r[l]; i-- && n !== r[i];);
		})
		return m(r)
	},
	// DOM (sub)query
	find: function (c/**query-full**/, s, n, o, x/**/) { /**query-full**/
		try {
			/**/return this.filter(function (n){ return n.querySelectorAll(c) }) /**query-full**/
		} catch (e) {
			s = [], o = this, n = m(o), r.lastIndex = 0;
			(' '+c+',').replace(r, function (_, a, b, c, d, e, f) {
				_ && (a == ',' ? (n.each(function (n) { s.push(n) }), n = m(o)) : (a = m.s[b == ':' ? c : b || a || '']) ?
					(a = a.call(n, f || c, d, e, o)) ? (n = n.filter(a)) : (x = 'filter call failed: ') : (x = 'no matching filter found: '))
				if (x) throw x + _
			})
			return m(s).filter()
		}
	/**/}/**events**/,
	// DOM event binding
	on: function (t, c) {
		return this.each(function (n, h, a) {
			h = m[p].trigger
			n['_' + t] ? n['_' + t].push(c) : (n['_' + t] = [c], n[a = 'addEventListener'] ? n[a](t, h) : n.attachEvent('on' + t, h))
		})
	},
	// DOM event unbinding
	off: function (t, c) {
		return this.each(function (n, h, r) {
			h = m[p].trigger
			n['_' + t] = c && m[p].filter.call(n['_' + t], function () { return this != c })
			if (!(n['_' + t] || 0)[l]) n[r = 'removeEventListener'] ? n[r](t, h) : n.detachEvent('on' + t, h)
		})
	},
	// Event chain trigger
	trigger: function (t, r) {
		t = t || window.event
		t = t.type ? t : { type: t }
		t.target || (t.target = t.srcElement)
		return this instanceof m ? this.each(function(n){ m[p].trigger.call(n, t) }) :
			(m.each((n = t.srcElement || this)['_'+t.type], function(c){ r = c.call(n, t) === !1 && r }), !r)
	}/**html**/,
	// read/write HTML
	html : function(h){ return h === u ? this[0].innerHTML : this.each(function (n) { n.innerHTML = h }) }/**attr**/,
	// get/set Attributes
	attr: function(k, v){
		if (v === u && '' + k !== (k || '')) {
			for (v in k) this.attr(v, k[v])
			return this
		}
		return k && v !== u ? this.each(function (n) { n.setAttribute(k, v), n[k] = v }) : this[0] ?
			this[0][k] || (this[0].getAttribute && this[0].getAttribute(k)) || '' : ''
	}/**css**/,
	// get/set CSS attributes
	css: function(k, v){
		if (!v && '' + k !== (k || '')) {
			for (v in k) this.css(v, k[v])
			return this
		}
		return k && v ? this.each(function () { this.style[k] = v }) : this[0] ? this[0][v='currentStyle'] ? this[0][v][k] :
			window.getComputedStyle(this[0])[k] || this[0].style[k] : ''
	}/**class**/,
	// has/add/remove/toggle class names (convenience functions below)
	cls: function (v, n, h, r, t) {
		v = v == 'has' ? 0 : v
		r = eval('/\\b' + n + '\\b/g')
		t = this.each(function (t, c, i, j) {
			r.lastIndex = 0
			i = t[c = 'className'].replace(r, '')
			j = i != t[c]
			h = h || j
			v && (t[c] = i + { add: 1, toggle: !j }[v] ? ' ' + n : '')
		})
		return v ? r : h
	}/**value**/,
	// get/set value
	val: function (v) { return '' + v === v ? this.each(function (n) { value = v }) : this[0].value }/**selection**/,
	/*
		inspect/manipulate/create Selection
		m(s).sel() - inspect Selection -> { start, end, length, text }
		m(s).sel({ start: 0-n, end: 0-n, text: 'xy' }) -> create/manipulate selection
	*/
	sel: function (o, n, c, e, v) {
		n = this[0]
		v = 'value'
		v in n || (v = 'innerText')
		return n ? o ? ((o.text && (n[v] = n[v].substr(0, o.start||0) + o.text + n[v].substr((o.start||0)+(o.end||n[v][l])))),
			(o.start && o.end && (((c = d[c='createRange'] ? d[c]() : d.createTextRange())), c.setStart ?
			(c.setStart(n, o.start), c.setEnd(n, o.end)) : (c.moveToElementText(n), c.moveStart(o.start), c.moveEnd(o.end), c.select())), this)) :
			(o='selection', c = 1+n[o+'End'] ? { start: n[o+'Start'], end: n[o+'End'] } :
			(n.focus(), o = d[o].createRange(), c = n.createTextRange(), e = c.duplicate(), e.moveToBookmark(o.getBookmark()),
			e.setEndPoint('EndToStart', c), c = { start: e.text[l], end: e.text[l] + o.text[l] }),
			c.text = n[v].substr(c.start, (c[l] = c.end - c.start)), c): {}
	}/**position**/,
	pos: function () {
		function o (a, x, y, z) { return a && a[z = 'getBoundingClientRect'] && (a = a[z](), z = document.documentElement) ?
			{ left: (this.pageXOffset || z.scrollLeft) + a.left, top: (this.pageYOffset || z.scrollTop) + a.top} :
			a ? o(a.offsetParent, ~~x + ~~a.offsetLeft, ~~y + ~~a.offsetTop) : { left: x, top: y } }
		return o(this[0])
	}/**ajax-full**/,
	// convenient AJAX loading
	load: function (u, t, c) {
		t = this,
		c = function (h) {
			h = this.responseText
			t.each(function (n) { n.innerHTML = h })
		}
		m.ajax(u.url ? (u.callback = c, u) : { url: u, callback: c })
	}/**/,
	// this makes most development consoles interpret the output as Array
	splice: a.splice
}/**class-full**/
// class name convenience functions
'has add remove toggle'.replace(/\w+/g, function(x) {
	if (x) m[p][x+'Class'] = function (c) { return this.cls(x, c) }
})/**query-full**/
// Selector functions: each returns a function that will be used to filter the output (re-use where possible and reasonable)
m.s = {
	'[': function (k, c, v, i) {
		v = c ? eval('/' + ({'|=': '\\b', '~=': '\\b', '=': '^', '!=': '^'}[c] || '') +
			((v || '').replace(/[.+*()]/g, '\\\1') || '.+') +
			({'|=': '(-|$)', '~=': '\\b', '=': '$', '!=': '$'}[c] || '') + '/' + (i || '')) : /.+/;
		return function(n){ return !!(v.test(n[k] || (typeof n.getAttribute == 'function' && n.getAttribute(k)) || '') ^ (c == '!=')) };
	},
	'#': function (n) { return function (t){ return t.id === n } },
	'.': function (n) { return m.s['[']('className', '~=', n) },
	'': function (n) { return m.s['[']('nodeName', '=', n, 'i') },
	'*': function () { return function (n) { return n[g] && n[g]('*') } },
	'>': function () { return function (n, r, i) {
		for (r = [], n = n.childNodes, i = 0; n[i]; i++) n[i].nodeType == 1 && r.push(n[i]);
		return r }
	},
	'+': function () { return function (n) { for (;n = n.nextSibling;) if ((n||0).nodeType == 1) return [n] } },
	'~': function () { return function (n, r) {
		for (r = []; n = n.nextSibling; n && n.nodeType == 1 && r.push(n));
		return r }
	},
	'nth-of-type': function (c, s, i, n, r) {
		c = (c == 'odd' ? '2n+1' : c == 'even' ? '2n+0' : c).split(/n/), i = +c[0], s = c[1], r = r ? 'nextSibling' : 'previousSibling';
		return function (t, c) {
			for (t=this, c=1; t=t[r]; t.nodeType == 1 && (n == '*' || t.nodeName == this.nodeName) && c++);
			return !(s ? (c - s) % i : c - i);
		}
	},
	'nth-last-of-type': function (c) { return m.s['nth-of-type'](c, 0, 0, 0, 1) },
	'nth-child': function (c) { return m.s['nth-of-type'](c, 0, 0, '*') },
	'nth-last-child': function (c) { return m.s['nth-of-type'](c, 0, 0, '*', 1) },
	'first-of-type': function (t) { return function(n){ return n.parentNode[g](t == '*' ? t : n.nodeName)[0] == n } },
	'last-of-type': function (t) { return function(n){
		for (;(n = n.nextSibling||0);) if (n.nodeType == 1 && (t == '*' || (n.nodeName == this.nodeName))) return false;
		return true;
	} },
	'only-of-type': function (t) { return function(n){ return n.parentNode[g](t == '*' ? t : n.nodeName)[l] == 1 } },
	'first-child': function () { return m.s['first-of-type']('*') },
	'last-child': function () { return m.s['last-of-type']('*') },
	'only-child': function () { return m.s['only-of-type']('*') },
	empty: function () { return function (n) { return !n.childNodes[l] } },
	target: function (t) { return this['[']('id', '=', /^#(.+)$/.test(location.hash) ? RegExp.$1 : '#') },
	lang: function (c) { return this['[']('lang', '|=', c, 'i') },
	enabled: function () { return function (n) { return n.disabled === !1 } },
	disabled: function () { return function (n) { return !!n.disabled } },
	checked: function () { return function (n) { return !!n.checked } },
	not: function (n, a, b, c, d) { return n = m(n, d), function (i) { for (i = 0; n[i];) if (n[i++] == this) return !1; return !0 } },
	root: function() { return function(n){ return n == d.documentElement } },
	has: function(q) { return function(n){ return m(n).find(q)[l] > 0 } },
	contains: function (c, t, r) {
		t = function(n, r){ return n ? (n.nodeType == 3 && r.push(n.data), t(n.firstChild, r), t(n.nextSibling, r)) : r }
		return function(n) { return t(n.firstChild, r = []).join('').indexOf(c)>-1 }
	},
	hidden: function (v) {return function (n, s) { return !!(!v ^ !(n.offsetWidth * n.offsetHeight || 
		((s = n.currentStyle || { visibility: 0, display: 0 }).visibility == 'hidden' || s.display == 'none'))) } },
	visible: function () { return m.s.hidden() },
	odd: function(i) { return function(){ return (i = !i) } },
	even: function(i) { return function(){ return !(i = !i) } },
	eq: function(i) { i |= 0; return function(){ return !i-- } },
	first: function() { return m.s.eq(0) },
	last: function() { return m.s.eq(this[l]-1) },
	seq: function(s) { s = s.split(','); return function(n, i){ return i >= s[0] && (isNaN(s[1]) || i < s[1]) } },
	gt: function(i) { return m.s.seq(''+i) },
	lt: function(i) { return m.s.seq('0,'+i) }
}
// extra selectors
m.s[' '] = m.s['*']
'checkbox file image password radio reset submit text'.replace(/\w+/g, function (x) {
	if (x) m.s[x] = function(){ return function(n) { return (n.type || '').toLowerCase() == x }}
});/**/
// Iterator: m.each([object/array], [callback])
m.each = function (a, b, c) {
	for (c in a) (a[l] + 1 ? isNaN(c) : !a.hasOwnProperty(c)) || b.call(a[c], a[c], !isNaN(c) ? +c : c, a);
	return a
}/**ajax**/
/* Ajax:
	m.ajax({
		url: '[required: url string]',
		method: '[optional: get*|post|head]',
		callback: [optional: function],
		init: [optional, requires init: function],
		header: [optional, requires header: function],
		user: [optional: username string],
		password: [optional: password string],
		data: [optional: data string]
	})
	returns RequestObject for synchronous or asynchronous use (latter only if callback is specified)
*/
m.ajax = function (o, x) {
	x = new XMLHttpRequest()
	x.open(o.method || 'get', o.url, o.callback && (x.onreadystatechange = o.callback), o.user, o.password)/**ajax-init**/
	o.init && o.init(x)/**ajax-header**/
	m.each(o.header||[], function(v, k) { x.setRequestHeader(k, v) })/**ajax**/
	x.send(o.data)
	return x
}/**jsonp**/
/* JSONp:
	m.jsonp({
		url: '[required: url string]',
		callback: [optional: callback function],
		"_": '[optional: callback name - do not use unless you know what you are doing]'
	})
*/
m.jsonp = function (o, h, s) {
	h = d.getElementsByTagName('head')[0],
	s = d.createElement(j),
	o.callback && (this[o._ = o._ || j + 0 | i++ * new Date()] = function(){
		h.removeChild(s)
		o.callback.apply(this, arguments)
		delete this[[]._]
	}),
	s.src = o.url.replace(/\??$/, o._),
	h.appendChild(s)
	return s
}/**cookie**/
/* Cookie
	m.cookie([required:cookie name string]) // returns cookie if set or ''
	m.cookie({
		name: '[required: cookie name string]',
		value: '[required: cookie value string]',
		date: [optional: Date() object or time in milliseconds until expiry],
		domain: '[optional: domain string]',
		path: '[optional: path string]',
		extra: '[optional: extra string, e.g. "secure"]'
	}) // sets cookie based on object
*/
m[c] = function (o) {
	if ('' + o === o)
		return (eval('/(^|[ ;])'+e(o)+'=([^;]+)/')).test(d[c]) && unescape(RegExp.$2);
	o && o.name && o.value && (d[c] = e(o.name) + '=' + e(o.value) +
		(o.date ? ('; expires=' + (new Date(+o.date === o.date ? +new Date() + o.date : o.date)).toGMTString()) : '') +
		(o.domain ? ('; domain=' + o.domain) : '') +
		(o.path ? '; path=' + o.path : '') +
		(o.extra || '') + ';')
}/**url**/
/*
	m.url('url-string') // -> URL-object (similar to location, but o.search[key] yields value, though o.search+'' yields the full string
*/
m.url = function (u, o) {
	u = (u || location.href).match(/^([^:\/\?#\.]*:?)(\/\/([^\/\?#:]*))?:?(\d*)(\.*\/[^?#]*)(\\?[^#]*)?(#.*)?$/)
	o = { toString: function () { return '' + o.protocol + (o.host != '' ? '\/\/' : '') + o.host + o.pathname + o.search + o.hash; }, search: { toString: function(r, t) {
			r = []
			t = 'toString'
			m.each(this, function(v, k){ (k || t) != t && r.push(k + '=' + v) })
			return r.join('&')
		} } }
	'href protocol base hostname port pathname search hash'.replace(/\w+/g, function(k, v, r) {
		v = u.shift() || ''
		k != 'search' ? (o[k] = v) : v.replace(/([^\?&=]+)=?([^&]*)?/g, function(f, i, d) { if (k) o[k][unescape(i)] = unescape(d || '') })
	})
	o.host = o.hostname + (o.port != '' ? ':' + o.port : '');
	if (o.host.match(/^\.\.?$/)) o.path = o.host + o.path, o.host = '';
	return o;
}
m.each(m.url(), function(v, k){ m.url[k] = v })/**useragent**/
// useragent detection
m.ua = function (o, x, i, v) {
	o = { ua: navigator.userAgent.toLowerCase(), info: {} }
	x = 'browser'
	v = 'version'
	o.ua.replace(/[\(\)]/g, ';').replace(/\s*(\w*?\ ?\w+[\:\s]?[^\d\s;]*?)[\/\ ;](\d[.\w]*|)/g, function(f, k, v) { o.info[k] = o.info[k] || v || !0; });
	'msie1opr1firefox1seamonkey1aurora1iron1chrome1safari1opera1windows0windows nt0windows phone0windows rt0mac os0android0iphone0ipad0ipod0blackberry0rim0linux0'.replace(/(\D+)(\d)/g, function(n, c, d) {
		n = +d ? x : 'os'
		o.info[c] && (o[n] = o[n] || { name: c == 'opr' ? 'opera' : c == 'chrome' && +o.info[v] == 1 ? 'native' : c, version: (+d ? o.info[v] : 0) || o.info[c] },
			o[n][o[n].name] = parseFloat(o[n][v]) || o[n][v])
	});
	(i = +o.info.trident + 4) && (o.ua[x].renderMode = o.info[o.ua[x].name = 'msie'], o.ua[x].msie = o.ua[x].version = i);
	return o
}()/**/
}(
	document,
	'prototype'/**query-full**/,
	'getElementsByTagName'/**jsonp**/,
	'script'/**/,
	'length',
	[]/**cookie**/,
	'cookie',
	escape/**query-full**/,
	/*
		CSS3 Selector RegExp (matches a-f)
		a=[>~* +,] (traversal),
		b=[[#.:[]""] (marker: id, class, attr, pseudo, tag if empty),
		c=name,
		d="(" for pseudo, comparison for attr,
		e=attribute value
		f=pseudo value
	*/
	/\s*([,>~* +])\s*|([#.:[]?)([0-9A-Za-z-_]+)(?:([*\|\~\^\$!]?=)([^\]]+)\]|\(([^)]*)\)|)/g/**/
);
</script>
</head>
<body>
<h1>m².js - modular micro framework</h1>
<p>Modular microframework</p>
<ul>
<li>1.66kb - 14.28kb commented/uncompressed</li>
<li>785b - 9.19kb bytes compressed using Google Closure Compiler</li>
<li>481b - 3.85kb bytes compressed/gzipped using Google Closure Compiler</li>
</ul>
<p>&copy; 2013 Alex Kloss.</p>
<h2>Features</h2>
<ul>
	<li><input type="checkbox" id="basic" value="on" disabled="disabled" style="display:none" checked/>Basic Framework: Main Object, <a href="#domevents">DOMready</a>, <a href="#iterator">Iterator</a>
		<ul>
			<li>Easily extendable</li>
			<li>Minimal size</li>
			<li>Simple usage through chaining</li>
			<li>jQuery-like syntax</li>
			<li>Variable Compatibility (depending on size/features)</li>
			<li>Licensed under GPLv2</li>
		</ul>
	</li>
	<li><a href="#selectors">DOM Selection:</a> <label for="query-simple"><input type="radio" name="query" id="query-simple" value="simple" checked/> Simple (IE8+/querySelectorAll only)</label> <label for="query-full"><input type="radio" name="query" id="query-full" value="full"/> Full (all browsers, additional selectors)</label> <label for="query-performance"><input type="checkbox" name="query-performance" id="query-performance" value="on"> More performant (cross-browser-compatible) queries for id, name or tagname</label></li>
	<li><label for="events"><input type="checkbox" name="events" id="events" value="on"> DOM Events</label> <a href="#domevents">[doc]</a></li>
	<li><label for="elementready"><input type="checkbox" name="elementready" id="elementready" value="on"> ElementReady</label> <a href="#domevents">[doc]</a></li>
	<li><label for="html"><input type="checkbox" name="html" id="html" value="on"> HTML inspection/manipulation</label> <a href="#manipulation">[doc]</a></li>
	<li><label for="attr"><input type="checkbox" name="attr" id="attr" value="on"> DOM Attribute inspection/manipulation</label> <a href="#manipulation">[doc]</a></li>
	<li><label for="css"><input type="checkbox" name="css" id="css" value="on"> CSS Attribute inspection/manipulation</label> <a href="#manipulation">[doc]</a></li>
	<li> <a href="#manipulation">ClassName inspection/manipulation:</a> <label for="no-class"><input type="radio" name="class" id="no-class" value="none" checked/> None</label> <label for="class-simple"><input type="radio" name="class" id="class-simple" value="simple"/> Single Method m.cls('has|set|get|toggle', name, value)</label> <label for="class-full"><input type="radio" name="class" id="class-full" value="full"/> With convenience methods</label></li>
	<li><label for="value"><input type="checkbox" name="value" id="value" value="on"> Form Value inspection/manipulation</label> <a href="#manipulation">[doc]</a></li>
	<li><label for="selection"><input type="checkbox" name="selection" id="selection" value="on"> Selection inspection/manipulation</label> <a href="#manipulation">[doc]</a></li>
	<li><label for="position"><input type="checkbox" name="position" id="position" value="on"> Position</label> <a href="#manipulation">[doc]</a></li>
	<li><a href="#networking">AJAX:</a> <label for="no-ajax"><input type="radio" name="ajax" id="no-ajax" value="none" checked/> None</label> <label for="ajax-simple"><input type="radio" name="ajax" id="ajax-simple" value="simple"/> Simple</label> <label for="ajax-full"><input type="radio" name="ajax" id="ajax-full" value="full"/> With convenience loader</label> <label for="ajax-init"><input type="checkbox" name="ajax-init" id="ajax-init" value="on"/> Init Callback</label> <label for="ajax-header"><input type="checkbox" name="ajax-header" id="ajax-header" value="on"/> Header Manipulation</label></li>
	<li><label for="jsonp"><input type="checkbox" name="jsonp" id="jsonp" value="on"> JSONp</label> <a href="#networking">[doc]</a></li>
	<li><label for="cookie"><input type="checkbox" name="cookie" id="cookie" value="on"> Cookies</label> <a href="#networking">[doc]</a></li>
	<li><label for="url"><input type="checkbox" name="url" id="url" value="on"> URL</label> <a href="#networking">[doc]</a></li>
	<li><label for="useragent"><input type="checkbox" name="useragent" id="useragent" value="on"> UserAgent</label> <a href="#client">[doc]</a></li>
</ul>
<button id="build">Build</button> <button id="full">Full</button> <button id="minimal">Minimal</button> <span id="length"></span>
<h2>Development Code</h2>
<pre id="devcode">[Code appears here]</pre>
<h2>Compiled Code</h2>
<pre id="livecode">[Code appears here]</pre>
<script type="text/javascript">
/* for debugging purposes on ie */
m.prototype.toString = function(r){
	r = [];
	this.each(function(n, i, t){
		t = '<' + n.nodeName.toLowerCase();
		'id class type name'.replace(/\w+/g, function(k) { t += m(n).attr(k) ? ' ' + k + '="' + m(n).attr(k) + '"' : '' });
		r.push((i && (i % 10 == 0) ? '\n' : '') + t + '>');
	})
	return 'm('+this.length+')[' + r.join(', ') + ']';
}/**/
m(function(){
	document.createElement('t');
	var jsre = /(\B\/(?:\\.|[^\n/*])(?:\\.|[^\n/])*\/[gim]*)|("(?:\\.|\\\r*\n|[^\n"])*"|'(?:\\.|\\\r*\n|[^\n'])*')|(\/\/[^\n]*\n|\/\*[\x00-\xff\u00\uffff]*?\*\/)|\b(abstract|boolean|break|byte|case|catch|char|class|const|continue|debugger|default|delete|do|double|else|enum|export|extends|false|final|finally|float|for|function|goto|if|implements|import|in|instanceof|int|interface|long|native|new|null|package|private|protected|public|return|short|static|super|switch|synchronized|this|throw|throws|transient|true|try|typeof|var|void|volatile|while|with)\b|\b(Array|Boolean|Date|Function|Math|Number|Object|RegExp|String|document|window|arguments)\b|(\d[\d\.eE]*)|([\x28-\x2b\x2d\x3a-\x3f\x5b\x5d\x5e\x7b-\x7e]+|\x2f|\.(?=\D))/g,
		jshighlight = function(c,r){return c.replace(r,function(f,i){for(i=7;~i*!arguments[i--];);return i?'<t class=f'+i+'>'+f.replace('<','&lt;')+'</t>':''})},
	jspreparemsie = function(d){return jshighlight(d.replace(/(['"])(.*?)\1/g,function(f,q,s){return q+s.replace(/&/g,'&amp;')+q}),jsre).replace(/\n/g, '<br>').replace(/\t/g, ' &nbsp; &nbsp;')},
		jsprepare = function(d){return jshighlight(d.replace(/(['"])(.*?)\1/g,function(f,q,s){return q+s.replace(/&/g,'&amp;')+q}),jsre)},
		toKB = function(b){ return (b/1024).toFixed(2).replace(/0+$/, '') },
		build = function(s, r){
			s = '';
			r = m('script').html().replace(/([^\0]*?)\/\*\*([\w-]*?)\**\//g, function(f, c, n) {
				f = (!s || (s.replace(/\s+/g, '')) && m('[id^='+s+']:checked').length) ? c : '';
				s = n;
				return f
			});
			s = r.length+' bytes commented/uncompressed' + (r.length > 1024 ? ' (' + toKB(r.length) + 'kb)' : '')
			m('#devcode').html((m.ua.browser.renderMode || m.ua.browser.msie) < 8 ? jspreparemsie(r) : jsprepare(r))
			if (m.ua.browser.msie) {
				r = { compiledCode: '/* CORS Request to Google\'s Closure Compiler REST service not supported by MSIE */' };
			} else {
				r = JSON.parse(m.ajax({url: 'http://closure-compiler.appspot.com/compile', method: 'post', header: { "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8" }, data: 'js_code='+encodeURIComponent(r)+'&compilation_level=ADVANCED_OPTIMIZATIONS&output_format=json&output_info=compiled_code&output_info=statistics'}).responseText)
				s += ', '+r.statistics.compressedSize+' bytes compressed'+(r.statistics.compressedSize > 1024 ? ' (' + toKB(r.statistics.compressedSize) + 'kb)' : '')+', ' + r.statistics.compressedGzipSize+' bytes compressed/gzipped'+(r.statistics.compressedGzipSize > 1024 ? ' (' + toKB(r.statistics.compressedGzipSize) + 'kb)' : '')
			}
			m('#length').html(s)
			m('#livecode').html((m.ua.browser.renderMode || m.ua.browser.msie) < 8 ? jspreparemsie(r.compiledCode) : jsprepare(r.compiledCode))
		};
	m('#build').on('click', build);
	m('#full').on('click', function(){ m('input').attr('checked', true) });
	m('#minimal').on('click', function(c){
		m('input:checkbox').attr('checked', false);
		m('label:first-of-type :radio').attr('checked', true);
	});
	m('#ajax-init, #ajax-header').on('change', function(){
		if (m('#ajax-init:checked, #ajax-header:checked').length > 0 &&
			m('#ajax-simple:checked, #ajax-full:checked').length == 0) {
			m('#ajax-simple').attr('checked', true);
		}
	});
	m('#no-ajax').on('change', function(){
		if (this.checked) { m('#ajax-init, #ajax-header').attr('checked', false) }
	})
});
//m(function(){console.log('iterator ready')}, '#iterator');
</script>
<h2>TODO</h2>
<ul>
	<li>More/Improved Documentation</li>
	<li>Test Suite for events, elementready, html, attr, css, val, pos, jsonp, cookies, url</li>
	<li>More modular control over selectors (maybe even additional selectors)</li>
	<li>Additional functionality (as modules)
		<ul>
			<li>serialize (as optional part of (.val)?)</li>
			<li>.live() Events</li>
			<li>.post() requests</li>
			<li>?</li>
		</ul>
	</li>
	<li>Improved (more beautiful) code
		<ul>
			<li>m().sel - IE Fallback (modularity?)</li>
		</ul>
	</li>
	<li>Cheat Sheet</li>
</ul>
<h2>Functionality</h2>
<style>
#functionality { margin: 0; padding: 0; }
#functionality li { font-size: 13px; }
#functionality label { background: #FFFFFF; border: 1px solid #DDDDDD; cursor: pointer; }
#selectors, #domevents, #manipulation, #iterator, #networking, #client { display: block; margin: 0; padding: 0 1em 1em; overflow: hidden;  }
#selectors { background: #FFFFCC; }
#selectors > ul > li { float: left; }
#pseudoattributes { width: 40em; }
#pseudoattributes li { float: left; width: 12em; }
#domevents { background: #FFEEDD; }
#manipulation { background: #FFEEEE; }
#manipulation > ul > li { float: left; margin-right: 3em; }
#iterator { background: #DDEEFF; }
#networking { background: #DDFFEE; }
#networking > ul > li { float: left; margin-right: 3em; }
#client { background: #EEEEEE; }
</style>
<ul id="functionality">
	<li id="selectors">
		<h3>m(s), m(s, b), m(n).find(s) - Selectors</h3>
		<h4><label for="selector-simple">Simple DOM Selection</label></h4>
		<p>Simple DOM Selection is solely based on <a href="http://www.w3.org/TR/selectors-api/#queryselectorall" target="_blank">querySelectorAll()</a>, which is <a href="http://caniuse.com/queryselector" target="_blank">not supported on some obsolete browsers</a> and may not provide all possible selectors.
		<h4><label for="selector-full">Full DOM Selection</label></h4>
		<ul>
			<li>
				<h5>Basic/Traversing</h5>
				<ul>
					<li>body - tag name</li>
					<li>#id - id</li>
					<li>.class - class name</li>
					<li>* - Everything</li>
					<li>&gt; - Direct Childs</li>
					<li>~ - Siblings</li>
					<li>+ - Next</li>
					<li>, - Multiple Selections</li>
				</ul>
			</li>
			<li>
				<h5>Attributes</h5>
				<ul>
					<li>[attr] - attribute presence</li>
					<li>[attr=value] - attribute value</li>
					<li>[attr!=value] - attribute negation</li>
					<li>[attr^=value] - attribute start</li>
					<li>[attr$=value] - attribute end</li>
					<li>[attr*=value] - attribute part</li>
					<li>[attr~=value] - Separate attribute part</li>
					<li>[attr|=value] - attribute subpart before -</li>
				</ul>
			</li>
			<li id="pseudoattributes">
				<h5>Pseudo Attributes</h5>
				<ul>
					<li>:first-child, :first</li>
					<li>:nth-child(2n+1)</li>
					<li>:nth-of-type(odd)</li>
					<li>:odd</li>
					<li>:even</li>
					<li>:eq(7)</li>
					<li>:last-child, :last</li>
					<li>:nth-last-child(even)</li>
					<li>:nth-last-of-type(3)</li>
					<li>:only-child</li>
					<li>:only-of-type</li>
					<li>:seq(2,5)</li>
					<li>:gt(2)</li>
					<li>:lt(5)</li>
					<li>:empty</li>
					<li>:target</li>
					<li>:lang(en)</li>
					<li>:enabled</li>
					<li>:disabled</li>
					<li>:checked</li>
					<li>:not([simple selector])</li>
					<li>:root</li>
					<li>:has([simple selector])</li>
					<li>:contains(text)</li>
					<li>:hidden</li>
					<li>:visible</li>
					<li>:checkbox</li>
					<li>:file</li>
					<li>:image</li>
					<li>:password</li>
					<li>:radio</li>
					<li>:reset</li>
					<li>:submit</li>
					<li>:text</li>
				</ul>
			</li>
		</ul>
	</li>
	<li id="domevents">
		<h3>m(f), m(s).on(t, f), m(s).off(t, f) - Events</h3>
		<ul>
			<li>m(f) - DOMready (basic)</li>
			<li>m(f, s) - <label for="elementready">ElementReady</label></li>
			<li>m(s).on(t, f) - Bind DOM Event*</li>
			<li>m(s).off(t, f) - Unbind DOM Event*</li>
			<li>m(s).trigger(t) - Trigger Event Chain</li>
		</ul>
		<p>* requires <label for="events">DOM Events</label></p>
	</li>
	<li id="manipulation">
		<h3>m(s).attr|css|html|cls|val - Manipulation/Inspection</h3>
		<ul>
			<li>
				<h4><label for="attr">m(s).attr - DOM Attributes</label></h4>
				<ul>
					<li>m(s).attr('name')</li>
					<li>m(s).attr('name', value)</li>
					<li>m(s).attr({name: 'value'})</li>
				</ul>
			</li>
			<li>
				<h4><label for="css">m(s).css - CSS Attributes</label></h4>
				<ul>
					<li>m(s).css('name')</li>
					<li>m(s).css('name', value)</li>
					<li>m(s).css({name: 'value'})</li>
				</ul>
			</li>
			<li>
				<h4><label for="html">m(s).html - HTML Content</label></h4>
				<ul>
					<li>m(s).html()</li>
					<li>m(s).html('&lt;html code&gt;')</li>
				</ul>
			</li>
			<li>
				<h4><label for="class-simple">m(s).cls - ClassName</label></h4>
				<ul>
					<li>m(s).cls('has|set|remove|toggle', 'name', 'opt:value')</li>
					<li>m(s).hasClass('name')**</li>
					<li>m(s).setClass('name')**</li>
					<li>m(s).removeClass('name')**</li>
					<li>m(s).toggleClass('name')**</li>
				</ul>
				<p>** Convenience Methods provided by <label for="class-full">additional module</label></p>
			</li>
			<li>
				<h4><label for="value">m(s).val(), m(s).val(v) - Value</label></h4>
				<ul>
					<li>m(s).val() - gets value of the first selected node</li>
					<li>m(s).val(v) - sets value of every field</li>
				</ul>
			</li>
			<li>
				<h4><label for="selection">m(s).sel(), m(s).sel(o) - Selection</label></h4>
				<ul>
					<li>m(s).sel() - gets selection object</li>
					<li>m(s).sel(o) - create/manipulate selection depending on object (length ignored)</li>
				</ul>
				<h5>Selection Object</h5>
				<ul>
					<li>start - start of selection (beginning at 0)</li>
					<li>end - end of selection</li>
					<li>length - length of selection</li>
					<li>text - selected text (or replacement)</li>
				</ul>
				<input type="text" id="selectiontest" />
				<span id="selectionview"></span>
				<script type="text/javascript">
				(function(s){
					m('#selectiontest').on('mousedown', function(e) { s = 1 }).on('mouseup', function () { s = 0 }).on('mousemove', function(e) {
						if (!s) return;
						e = m('#selectiontest').sel()
						m('#selectionview').html(e.start + '-' + e.end + ': "' + e.text + '"')
					}).on('keyup', function(e){
						e = m('#selectiontest').sel()
						m('#selectionview').html(e.start + '-' + e.end + ': "' + e.text + '"')
					})
				})()
				</script>
			</li>
			<li><h4><label for="position">m(s).pos() - Position</label></h4>
				<p>m(s).pos() // returns position object</p>
				<h5>Position Object</h5>
				<ul>
					<li>.left - horizontal position in pixels</li>
					<li>.top - vertical position in pixels</li>
				</ul>
				<p>Position coordinates may be floating point numbers</p>
			</li>
		</ul>
	</li>
	<li id="iterator">
		<h3>m.each(o, f), m(s).each(f), m(s).filter(f) - Iterator</h3>
		<ul>
			<li>m.each({key, value}, function(value, key){ /* this == value */ })</li>
			<li>m.each([1, 2, 3], function(value, key){ /* this == value */ })</li>
			<li>m(s).each(function(node, idx){ /* this == node */ })</li>
			<li>m(s).filter(function(node, idx){ return true || NodeCollection })</li>
		</ul>
	</li>
	<li id="networking">
		<h3>m.ajax(o), m.jsonp(o), m.cookie(o), m.url(o) - Networking/Server</h3>
		<ul>
			<li>
				<h4><label for="ajax-simple">m.ajax(o)</label></h4>
				m.ajax({configuration object}) - yields AJAX Request object
				<h5>Configuration Object</h5>
				<ul>
					<li>url (required): Request URL</li>
					<li>method (optional): [get]|head|post</li>
					<li>callback (optional): called on readyStateChange, makes request async</li>
					<li>user (optional): username for HTTP/Auth</li>
					<li>password (optional): password for HTTP/Auth</li>
					<li>data (optional): data for POST request</li>
					<li>init (optional, requires <label for="ajax-init">AJAX init</label>): init callback</li>
					<li>header (optional, requires <label for="ajax-header">AJAX header</label>): header object</li>
				</ul>
				<br/>m(s).load(url), m(s).load(obj) - <label for="ajax-full">Convenience loader</label>; callback not supported.
			</li>
			<li>
				<h4><label for="jsonp">m.jsonp(o)</label></h4>
				m.jsonp({configuration object}) - yields script tag for JSONp-Request
				<h5>Configuration Object</h5>
				<ul>
					<li>url (required): Request URL, "?" at the end will be replaced with callback name</li>
					<li>callback (optional): will be called from JSONp-Request</li>
					<li>_ (optional): callback name, if it needs to be pre-defined</li>
				</ul>
			</li>
			<li>
				<h4><label for="cookies">m.cookie(o)</label></h4>
				m.cookie(name) - returns cookie value<br/>
				m.cookie({cookie object})
				<h5>Cookie Object</h5>
				<ul>
					<li>name (required): Cookie name</li>
					<li>value (required): Cookie value</li>
					<li>date (optional): Date() object or time in milliseconds until expiry</li>
					<li>domain (optional): domain string</li>
					<li>path (optional): path string</li>
					<li>extra (optional): extra string, e.g. "secure"</li>
				</ul>
			</li>
			<li>
				<h4><label for="url">m.url(u)</label></h4>
				m.url("URL string") - returns URL object<br/>
				m.url.hostname - m.url serves as the page's URL object, too
				<h5>URL Object</h5>
				The URL Object is rather similar to window.location, the main differences is the url.search (which will perform as an key-value storage for everything in its search, but yield an URI-Encoded string if coerced)
			</li>
		</ul>
	</li>
	<li id="client">
		<h3><label for="useragent">m.ua - Browser/OS</label></h3>
		m.ua.
		<ul>
			<li>
				browser.
				<ul>
					<li>name: <script type="text/javascript">document.write(m.ua.browser.name);</script></li>
					<li>version: <script type="text/javascript">document.write(m.ua.browser.version);</script></li>
					<li><script type="text/javascript">document.write(m.ua.browser.name);</script>: <script type="text/javascript">document.write(m.ua.browser[m.ua.browser.name]);</script></li>
					<script type="text/javascript">if (m.ua.browser.renderMode) document.write('<li>renderMode: '+m.ua.browser.renderMode+'</li>');</script>
				</ul>
			</li>
			<li>
				os.
				<ul>
					<li>name: <script type="text/javascript">document.write(m.ua.os.name);</script></li>
					<li>version: <script type="text/javascript">document.write(m.ua.os.version);</script></li>
					<li><script type="text/javascript">document.write(m.ua.os.name);</script>: <script type="text/javascript">document.write(m.ua.os[m.ua.os.name]);</script></li>
				</ul>
			</li>
			<li>info: Hash aller weiteren UA-Eigenschaften (key=value oder key=true)</li>
			<li>ua: navigator.userAgent.toLowerCase() // <script type="text/javascript">document.write(m.ua.ua);</script></li>
		</ul>
	</li>
</ul>
<h2>Tests</h2>
<style>
#testresults p { margin: 0; padding: 0; }
</style>
<div id="testresults"></div>
<button id="run">Run</button>
<script type="text/javascript">
(function(){
	var assert = function(assertion, result, msg) {
		msg = msg || [];
		if (typeof assertion !== typeof result) msg.push('types differ: '+typeof assertion+' vs. '+typeof result);
		else if (assertion instanceof Array || assertion instanceof m || (typeof assertion == 'object' && !assertion.nodeName)) {
			m.each(assertion, function(v, k){ assert(v, result[k], msg) });
		} else if (assertion != result) msg.push('different result');
		return msg.length ? msg : true
	},
	testfilter = function(filter, obj, args) {
		if (typeof obj == 'string') {
			var div = document.createElement('div');
			div.innerHTML = obj;
			if (args) args[4] = div, filter = filter.apply(m.s, args);
			obj = m(div.getElementsByTagName('*'))
		} else {
			if (args) args[4] = obj, filter = filter.apply(m.s, args);
		}
		return m.prototype.filter.call(obj, filter);
	},
	tests = [
		{
			description: '<h3>Iterator tests</h3>'
		},
		{
			description: 'array iterator',
			run: function(r, c){
				c = [1,2,3],
				r = '';
				m.each(c, function(n, i){
					if (!n) r += ' ERROR: empty/false element';
					if (n != this) r += ' ERROR: this/arg[0] differ';
					if (!(i in c)) r += ' ERROR: wrong index';
					if (+n !== n || n < 0 || n > 3) r += ' ERROR: element outside array';
					if (i + 1 != n) r += ' ERROR: element/index mismatch: '+i+'&rarr;'+n;
				}) == c || (r += ' ERROR: wrong/missing return value');
				return r || true;
			}
		},
		{
			description: 'object iterator',
			run: function(r, c){
				c = { a: 1, b: 2, c: 3 },
				r = '';
				m.each(c, function(n, i){
					if (!n) r += ' ERROR: empty/false element';
					if (n != this) r += ' ERROR: this/arg[0] differ';
					if (!(i in c) || !/[abc]/.test(i)) r += ' ERROR: wrong index';
					if (+n !== n || n < 0 || n > 3) r += ' ERROR: element outside object';
					if (parseInt(i, 36) - 9 != n) r += ' ERROR: element/index mismatch';
				}) == c || (r += ' ERROR: wrong/missing return value');
				return r || true;
			}
		},
		{
			description: '<h3>Selector filter tests</h3>'
		},
		{
			description: 'tagname filter',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['']('li'), '<span><\/span><div><\/div><ul><li><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: 'id filter',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['#']('test'), '<span><\/span><div id="test"><\/div><ul><li><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: 'class name filter',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['.']('test'), '<span><\/span><div class="test"><\/div><ul><li class="test"><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 2) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: 'recursive child filter',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['*'](), '<div><span><\/span><div class="test"><\/div><ul><li class="test"><\/li><\/ul><a><\/a><img/></div>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 6) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'ul') r += ' ERROR: wrong element matched'
				if (((n[3] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				if (((n[4] || 0).nodeName || '').toLowerCase() != 'a') r += ' ERROR: wrong element matched'
				if (((n[5] || 0).nodeName || '').toLowerCase() != 'img') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: 'direct child filter',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['>'](), '<span><\/span><div class="test"><\/div><ul><li class="test"><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: 'sibling filter',
			run: function(res, n){
				res = '';
				n = testfilter(m.s['~'](), '<span><\/span><div class="test"><\/div><ul><li class="test"><\/li><\/ul><a><\/a><img/>');
				if (!n) res += ' ERROR: empty result';
				if (n.length != 4) res += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'div') res += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'ul') res += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'a') res += ' ERROR: wrong element matched'
				if (((n[3] || 0).nodeName || '').toLowerCase() != 'img') res += ' ERROR: wrong element matched'
				return res || true
			}
		},
		{
			description: 'next filter',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['+'](), '<span><div class="test"><\/div><ul><li class="test"><\/li><\/ul><a><\/a><img/><\/span>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 3) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'ul') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'a') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'img') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: 'multiple selectors',
			run: function(r, n) {
				r = '';
				n = m('#build, #full, #minimal');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 3) r += ' ERROR: wrong number of matched elements';
				if ((n[0] || 0).id != 'build') r += ' ERROR: wrong element matched'
				if ((n[1] || 0).id != 'full') r += ' ERROR: wrong element matched'
				if ((n[2] || 0).id != 'minimal') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: 'attribute filter (without comparison)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['[']('data-test', '', ''), '<span><\/span><div><\/div><ul><li data-test="present"><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: 'attribute filter (equal comparison)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['[']('data-test', '=', 'present'), '<span><\/span><div data-test="not present"><\/div><ul><li data-test="present"><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: 'attribute filter (unequal comparison)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['[']('data-test', '!=', 'not present'), '<span><\/span><div data-test="not present"><\/div><ul><li data-test="present"><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 5) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'ul') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				if (((n[3] || 0).nodeName || '').toLowerCase() != 'a') r += ' ERROR: wrong element matched'
				if (((n[4] || 0).nodeName || '').toLowerCase() != 'img') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: 'attribute filter (start comparison)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['[']('data-test', '^=', 'not'), '<span data-test="not filled"><\/span><div data-test="not present"><\/div><ul><li data-test="present"><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 2) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: 'attribute filter (end comparison)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['[']('data-test', '$=', 'present'), '<span data-test="not filled"><\/span><div data-test="not present"><\/div><ul><li data-test="present"><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 2) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: 'attribute filter (part comparison)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['[']('data-test', '*=', 'pre'), '<span data-test="not prefilled"><\/span><div data-test="not present"><\/div><ul><li data-test="present"><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 3) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: 'attribute filter (subpart comparison)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['[']('data-test', '~=', 'not'), '<span data-test="still not prefilled"><\/span><div data-test="not present"><\/div><ul><li data-test="present"><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 2) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: 'attribute filter (subpart before "-" comparison)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['[']('data-test', '|=', 'de'), '<span data-test="de-DE en-EN"><\/span><div data-test="not present"><\/div><ul><li data-test="present"><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: '<h3>pseudo attribute filter</h3>'
		},
		{
			description: ':root',
			run: function(r, n){
				r = '';
				n = m([document, document.documentElement, document.body]).filter(m.s.root())
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (n[0] != document.documentElement) r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':first',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['first'](), '<span><\/span><div><\/div><ul><li><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':last',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['last'].call({length: 6}), '<span><\/span><div><\/div><ul><li><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'img') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':first-child',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['first-child'](), '<span><\/span><div><\/div><ul><li><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 2) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':last-child',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['last-child'](), '<span><\/span><div><\/div><ul><li><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 2) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'img') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':only-child',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['only-child'](), '<span><\/span><div><p><\/p><p><\/p><\/div><ul><li><\/li><\/ul><a><img/><\/a>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 2) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'img') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':odd',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['odd'](), '<span><\/span><div><\/div><ul><li><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 3) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'ul') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'a') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':even',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['even'](), '<span><\/span><div><\/div><ul><li><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 3) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'img') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':empty',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['empty'](), '<span><\/span><div><\/div><ul><li><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 5) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				if (((n[3] || 0).nodeName || '').toLowerCase() != 'a') r += ' ERROR: wrong element matched'
				if (((n[4] || 0).nodeName || '').toLowerCase() != 'img') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':lang()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['lang']('de'), '<span lang="de-DE"><\/span><div lang="de-AT"><\/div><ul><li lang="en-EN"><\/li><\/ul><a lang="de"><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 3) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'a') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':eq()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['eq'](1), '<span><\/span><div><\/div><ul><li><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':nth-child() (1/3)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['nth-child']('3'), '<span><\/span><div><\/div><ul><li><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'ul') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':nth-child() (2/3)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['nth-child']('3n+1'), '<span><\/span><div><\/div><ul><li><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 3) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'a') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':nth-child() (3/3)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['nth-child']('4n-1'), '<span><\/span><div><\/div><ul><li><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'ul') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':nth-last-child() (1/3)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['nth-last-child']('2'), '<span><\/span><div><\/div><ul><li><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'a') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':nth-last-child() (2/3)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['nth-last-child']('3n+1'), '<span><\/span><div><\/div><ul><li><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 3) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'img') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':nth-last-child() (3/3)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['nth-last-child']('4n-2'), '<span><\/span><div><\/div><ul><li><\/li><\/ul><a><\/a><img/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'a') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':nth-of-type() (1/3)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['nth-of-type']('2'), '<span><\/span><span><\/span><span><\/span><div><\/div><ul><li><\/li><li><\/li><\/ul><div><\/div><a><\/a><img/><div><\/div>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 3) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'					
				return r || true
			}
		},
		{
			description: ':nth-of-type() (2/3)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['nth-of-type']('3n+2'), '<span><\/span><span><\/span><span><\/span><div><\/div><ul><li><\/li><li><\/li><\/ul><div><\/div><a><\/a><img/><div><\/div>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 3) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':nth-of-type() (3/3)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['nth-of-type']('4n-1'), '<span><\/span><span><\/span><span><\/span><div><\/div><ul><li><\/li><li><\/li><\/ul><div><\/div><a><\/a><img/><div><\/div>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 2) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':nth-last-of-type() (1/3)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['nth-last-of-type']('2'), '<span><\/span><span><\/span><span><\/span><div><\/div><ul><li><\/li><li><\/li><\/ul><div><\/div><a><\/a><img/><div><\/div>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 3) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'					
				return r || true
			}
		},
		{
			description: ':nth-of-type() (2/3)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['nth-last-of-type']('3n+2'), '<span><\/span><span><\/span><span><\/span><div><\/div><ul><li><\/li><li><\/li><\/ul><div><\/div><a><\/a><img/><div><\/div>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 3) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':nth-of-type() (3/3)',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['nth-last-of-type']('4n-1'), '<span><\/span><span><\/span><span><\/span><div><\/div><ul><li><\/li><li><\/li><\/ul><div><\/div><a><\/a><img/><div><\/div>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 2) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':only-of-type()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['only-of-type'](), '<span><\/span><span><\/span><span><\/span><div><\/div><ul><li><\/li><li><\/li><\/ul><div><\/div><a><\/a><img/><div><\/div>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 3) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'ul') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'a') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'img') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':first-of-type()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['first-of-type'](), '<span><\/span><span><\/span><span><\/span><div><\/div><ul><li><\/li><li><\/li><\/ul><div><\/div><div><\/div>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 4) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'ul') r += ' ERROR: wrong element matched'
				if (((n[3] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':last-of-type()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['last-of-type'](), '<span><\/span><span><\/span><span><\/span><div><\/div><ul><li><\/li><li><\/li><\/ul><div><\/div><div><\/div>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 4) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'ul') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				if (((n[3] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':seq()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['seq']("2,5"), '<span><\/span><span><\/span><span><\/span><div><\/div><ul><li><\/li><li><\/li><\/ul><div><\/div><div><\/div>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 3) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'ul') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':gt()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['gt']("6"), '<span><\/span><span><\/span><span><\/span><div><\/div><ul><li><\/li><li><\/li><\/ul><div><\/div><div><\/div>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 3) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':lt()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['lt']("3"), '<span><\/span><span><\/span><span><\/span><div><\/div><ul><li><\/li><li><\/li><\/ul><div><\/div><div><\/div>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 3) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':target()',
			run: function(r, n){
				r = '';
				location.hash = 'test';
				n = testfilter(m.s['target'](), '<span><\/span><span><\/span><span><\/span><div id="test"><\/div><ul><li><\/li><li><\/li><\/ul><div><\/div><div><\/div>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':enabled()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['enabled'](), '<input name="i1" type="submit" disabled="disabled" /><a href="#"><\/a><input type="text" disabled name="i2" value=""/><input name="i3"/><select name)"s1" disabled><\/select><input name="i4" />');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 2) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'input') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'input') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':disabled()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['disabled'](), '<input name="i1" type="submit" disabled="disabled" /><a href="#"><\/a><input type="text" disabled name="i2" value=""/><input name="i3"/><select name)"s1" disabled><\/select><input name="i4" />');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 3) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'input') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'input') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'select') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':checked()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['checked'](), '<input name="i1" type="radio" disabled="disabled" checked="checked" /><a href="#"><\/a><input type="radio" name="i1" value=""/><input type="checkbox" name="i3"/><input type="checkbox" name="i4" checked="checked" />');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 2) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'input') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'input') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':not()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['not'], '<span><\/span><span><\/span><span><\/span><div><\/div><ul><li><\/li><li><\/li><\/ul><div><\/div><div><\/div>', ['span, li']);
				if (!n) r += ' ERROR: empty result';
				if (n.length != 4) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'ul') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				if (((n[3] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':has()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['has']('li'), '<span><\/span><span><\/span><span><\/span><div><\/div><ul><li><\/li><li><\/li><\/ul><div><\/div><div><\/div>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'ul') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':contains()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['contains']('abc'), '<span>abc<\/span><span>abc def<\/span><span>xyz<\/span><div><\/div><ul><li>abc<\/li><li><\/li><\/ul><div>test abc<\/div><div><\/div>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 5) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'span') r += ' ERROR: wrong element matched'
				if (((n[2] || 0).nodeName || '').toLowerCase() != 'ul') r += ' ERROR: wrong element matched'
				if (((n[3] || 0).nodeName || '').toLowerCase() != 'li') r += ' ERROR: wrong element matched'
				if (((n[4] || 0).nodeName || '').toLowerCase() != 'div') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':hidden()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['hidden']('hidden'), m('ul:eq(1) input'));
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'input') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':visible()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['visible'](), m('ul:eq(1) input:lt(3)'));
				if (!n) r += ' ERROR: empty result';
				if (n.length != 2) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'input') r += ' ERROR: wrong element matched'
				if (((n[1] || 0).nodeName || '').toLowerCase() != 'input') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':checkbox()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['checkbox'](), '<input type="checkbox"/><input type="file"/><input type="image"/><input type="password"/><input type="radio"/><input type="reset"/><input type="submit"/><input type="text"/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'input' && (n[0] || 0).type != 'checkbox') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':file()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['file'](), '<input type="checkbox"/><input type="file"/><input type="image"/><input type="password"/><input type="radio"/><input type="reset"/><input type="submit"/><input type="text"/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'input' && (n[0] || 0).type != 'file') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':image()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['image'](), '<input type="checkbox"/><input type="file"/><input type="image"/><input type="password"/><input type="radio"/><input type="reset"/><input type="submit"/><input type="text"/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'input' && (n[0] || 0).type != 'image') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':password()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['password'](), '<input type="checkbox"/><input type="file"/><input type="image"/><input type="password"/><input type="radio"/><input type="reset"/><input type="submit"/><input type="text"/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'input' && (n[0] || 0).type != 'password') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':radio()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['radio'](), '<input type="checkbox"/><input type="file"/><input type="image"/><input type="password"/><input type="radio"/><input type="reset"/><input type="submit"/><input type="text"/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'input' && (n[0] || 0).type != 'radio') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':reset()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['reset'](), '<input type="checkbox"/><input type="file"/><input type="image"/><input type="password"/><input type="radio"/><input type="reset"/><input type="submit"/><input type="text"/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'input' && (n[0] || 0).type != 'reset') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':submit()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['submit'](), '<input type="checkbox"/><input type="file"/><input type="image"/><input type="password"/><input type="radio"/><input type="reset"/><input type="submit"/><input type="text"/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'input' && (n[0] || 0).type != 'submit') r += ' ERROR: wrong element matched'
				return r || true
			}
		},
		{
			description: ':text()',
			run: function(r, n){
				r = '';
				n = testfilter(m.s['text'](), '<input type="checkbox"/><input type="file"/><input type="image"/><input type="password"/><input type="radio"/><input type="reset"/><input type="submit"/><input type="text"/>');
				if (!n) r += ' ERROR: empty result';
				if (n.length != 1) r += ' ERROR: wrong number of matched elements';
				if (((n[0] || 0).nodeName || '').toLowerCase() != 'input' && (n[0] || 0).type != 'text') r += ' ERROR: wrong element matched'
				return r || true
			}
		}
	];
	m('#run').on('click', function(){
		m.each(tests, function(test, div, result){
			div = document.createElement('div');
			if (test.requires && !test.requires()) {
				div.innerHTML = '<p>Requirements not met.</p>'
			} else if (test.run) {
				try { result = test.run() } catch (e){ result = ''+e }
				result = result === true ? 'OK' : result
				div.innerHTML = '<p>' + test.description + ': ' + result + '<\/p>';
			} else {
				div.innerHTML = test.description;
			}
			m('#testresults')[0].appendChild(div);
		});
		m('#run')[0].parentNode.removeChild(m('#run')[0])
	});
})()
</script>
</body>
</html>
